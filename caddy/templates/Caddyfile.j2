{% for subdomain in services -%}
{{ subdomain }}.{{ domain_name }}{% if services[subdomain].http is defined %}:80{% endif %} {
{% if services[subdomain].user is defined %}
  basic_auth {
    {{ services[subdomain].user }} {{ services[subdomain].password }}
  }
{% endif %}
{% if services[subdomain].autostop is defined %}
  route {{ services[subdomain].autostop.path }} {
  sablier http://localhost:10000 {
    names {{ services[subdomain].autostop.names }}
    dynamic
  }
  }
{% endif %}
  reverse_proxy localhost:{{ services[subdomain].port }}
}

{% endfor %}